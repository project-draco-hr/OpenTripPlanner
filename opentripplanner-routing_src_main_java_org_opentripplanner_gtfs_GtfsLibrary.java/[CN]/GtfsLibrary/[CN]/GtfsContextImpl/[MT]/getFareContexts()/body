{
  if (fareContexts == null) {
    fareContexts=new HashMap<AgencyAndId,FareContext>();
    Collection<FareRule> rules=getDao().getAllFareRules();
    for (    FareRule rule : rules) {
      FareAttribute fare=rule.getFare();
      AgencyAndId id=fare.getId();
      FareContext fareContext=fareContexts.get(id);
      if (fareContext == null) {
        fareContext=new FareContext();
        fareContexts.put(id,fareContext);
      }
      String contains=rule.getContainsId();
      if (contains != null) {
        fareContext.addContains(contains);
      }
      String origin=rule.getOriginId();
      String destination=rule.getDestinationId();
      if (origin != null || destination != null) {
        fareContext.addOriginDestination(origin,destination);
      }
      Route route=rule.getRoute();
      if (route != null) {
        AgencyAndId routeId=route.getId();
        fareContext.addRoute(routeId);
      }
    }
  }
  return fareContexts;
}
