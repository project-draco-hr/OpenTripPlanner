{
  if (initialized == true)   throw new IllegalStateException("A TraverseOptions should only be initialized once.");
  if (graph == null)   throw new IllegalStateException("Graph must be set before preparing for search.");
  findEndpointVertices();
  findIntermediateVertices();
  CalendarServiceData csData=graph.getService(CalendarServiceData.class);
  if (csData != null) {
    CalendarServiceImpl calendarService=new CalendarServiceImpl();
    calendarService.setData(csData);
    setCalendarService(calendarService);
  }
  setTransferTable(graph.getTransferTable());
  setServiceDays();
  if (getModes().isTransit() && !graph.transitFeedCovers(dateTime)) {
    throw new TransitTimesException();
  }
  if (!getModes().isTransit()) {
    numItineraries=1;
    setMaxWalkDistance(Double.MAX_VALUE);
  }
  this.initialized=true;
}
