{
  GenericApplicationContext ctx=new GenericApplicationContext();
  XmlBeanDefinitionReader xmlReader=new XmlBeanDefinitionReader(ctx);
  for (  String path : paths) {
    if (path.startsWith(CLASSPATH_PREFIX)) {
      path=path.substring(CLASSPATH_PREFIX.length());
      xmlReader.loadBeanDefinitions(new ClassPathResource(path));
    }
 else     if (path.startsWith(FILE_PREFIX)) {
      path=path.substring(FILE_PREFIX.length());
      xmlReader.loadBeanDefinitions(new FileSystemResource(path));
    }
 else {
      xmlReader.loadBeanDefinitions(new FileSystemResource(path));
    }
  }
  for (  Map.Entry<String,BeanDefinition> entry : additionalBeans.entrySet())   ctx.registerBeanDefinition(entry.getKey(),entry.getValue());
  ctx.refresh();
  ctx.registerShutdownHook();
  return ctx;
}
