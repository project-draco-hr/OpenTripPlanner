{
  Coordinate c=new Coordinate(stop.getLon(),stop.getLat());
  List<Vertex> localTransitStops=indexService.getLocalTransitStops(c,LOCAL_STOP_SEARCH_RADIUS);
  HashSet<TripPattern> neighborhood=new HashSet<TripPattern>();
  for (  Vertex v : localTransitStops) {
    if (v instanceof TransitStop) {
      if (((TransitStop)v).isEntrance()) {
        for (        Edge e : v.getOutgoing()) {
          v=e.getToVertex();
          break;
        }
      }
      for (      Edge e : v.getOutgoing()) {
        for (        Edge e2 : e.getToVertex().getOutgoing()) {
          if (e2 instanceof TransitBoardAlight && ((TransitBoardAlight)e2).isBoarding()) {
            neighborhood.add(((TransitBoardAlight)e2).getPattern());
          }
 else           if (e2 instanceof FrequencyBoard) {
            neighborhood.add(((FrequencyBoard)e2).getPattern());
          }
        }
      }
    }
  }
  return neighborhood;
}
