{
  this.timeCutoffMinutes=timeCutoffMinutes;
  LOG.info("Caching distances to nearby street intersections from each transit stop...");
  for (  TransitStop tstop : graph.index.stopVertexForStop.values()) {
    RoutingRequest rr=new RoutingRequest(TraverseMode.WALK);
    rr.batch=(true);
    rr.setRoutingContext(graph,tstop,tstop);
    rr.worstTime=(rr.dateTime + timeCutoffMinutes * 60);
    GenericAStar astar=new GenericAStar();
    rr.longDistance=true;
    rr.setNumItineraries(1);
    ShortestPathTree spt=astar.getShortestPathTree(rr,5);
    TObjectIntMap<Vertex> distanceToVertex=new TObjectIntHashMap<>(1000,0.5f,Integer.MAX_VALUE);
    for (    State state : spt.getAllStates()) {
      distanceToVertex.put(state.getVertex(),(int)state.walkDistance);
    }
    distancesForStop.put(tstop,distanceToVertex);
    rr.cleanup();
  }
  LOG.info("Done caching distances to nearby street intersections from each transit stop.");
}
