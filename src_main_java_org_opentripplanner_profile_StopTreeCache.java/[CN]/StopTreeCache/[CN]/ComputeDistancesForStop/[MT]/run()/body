{
  RoutingRequest rr=new RoutingRequest(TraverseMode.WALK);
  rr.batch=(true);
  rr.setRoutingContext(graph,tstop,tstop);
  rr.worstTime=(rr.dateTime + timeCutoffMinutes * 60);
  AStar astar=new AStar();
  rr.longDistance=true;
  rr.dominanceFunction=new DominanceFunction.EarliestArrival();
  rr.setNumItineraries(1);
  ShortestPathTree spt=astar.getShortestPathTree(rr,5);
  TObjectIntMap<Vertex> distanceToVertex=new TObjectIntHashMap<>(1000,0.5f,Integer.MAX_VALUE);
  for (  State state : spt.getAllStates()) {
    distanceToVertex.put(state.getVertex(),(int)state.walkDistance);
  }
synchronized (distancesForStop) {
    distancesForStop.put(tstop,distanceToVertex);
  }
  rr.cleanup();
}
