{
  if (spawned)   throw new IllegalStateException("A StateEditor can only be used once.");
  if (defectiveTraversal) {
    LOG.error("Defective traversal flagged on edge " + child.backEdge);
    return null;
  }
  if (child.backState != null) {
    child.checkNegativeWeight();
    if (traversingBackward ? (child.getTimeDeltaSec() > 0) : (child.getTimeDeltaSec() < 0)) {
      LOG.trace("Time was incremented the wrong direction during state editing. {}",child.backEdge);
      return null;
    }
    if (!applyPatches()) {
      return null;
    }
  }
  if (!parsePath(this.child))   return null;
  if (this.notes != child.stateData.notes) {
    cloneStateDataAsNeeded();
    child.stateData.notes=this.notes;
  }
  spawned=true;
  return child;
}
