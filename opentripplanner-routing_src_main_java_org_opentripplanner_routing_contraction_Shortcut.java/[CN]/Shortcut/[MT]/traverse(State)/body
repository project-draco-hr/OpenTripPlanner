{
  if (weight == -1) {
    Edge first, second;
    if (s0.getOptions().isArriveBy()) {
      first=edge2;
      second=edge1;
    }
 else {
      first=edge1;
      second=edge2;
    }
    State s1=first.traverse(s0);
    if (s1 == null)     return null;
    State s2=second.traverse(s1);
    if (s2 == null)     return null;
    time=(int)(Math.abs(s0.getTime() - s2.getTime()) / 1000);
    weight=s2.getWeight() - s0.getWeight();
    mode=s2.getBackEdgeNarrative().getMode();
    walkDistance=s2.getWalkDistance() - s0.getWalkDistance();
  }
  StateEditor ret=s0.edit(this);
  ret.incrementTimeInSeconds(time);
  ret.incrementWeight(weight);
  ret.incrementWalkDistance(walkDistance);
  return ret.makeState();
}
