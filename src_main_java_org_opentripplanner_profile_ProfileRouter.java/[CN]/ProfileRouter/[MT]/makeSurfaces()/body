{
  LOG.info("Propagating profile router result to street vertices.");
  RoutingRequest rr=new RoutingRequest(TraverseMode.WALK);
  rr.setMode(TraverseMode.WALK);
  rr.walkSpeed=request.walkSpeed;
  int worstElapsedTime=request.accessTime * 60;
  rr.worstTime=(rr.dateTime + worstElapsedTime);
  rr.setBatch(true);
  GenericAStar astar=new GenericAStar();
  astar.setNPaths(1);
  for (  TransitStop tstop : graph.index.stopVertexForStop.values()) {
    int index=tstop.getIndex();
    if (mins[index] == TimeSurface.UNREACHABLE || maxs[index] == TimeSurface.UNREACHABLE)     continue;
    rr.setRoutingContext(graph,tstop,null);
    astar.setTraverseVisitor(new ExtremaPropagationTraverseVisitor(mins[index],maxs[index]));
    ShortestPathTree spt=astar.getShortestPathTree(rr,5);
    rr.rctx.destroy();
  }
  minSurface=new TimeSurface(this,false);
  maxSurface=new TimeSurface(this,true);
  LOG.info("done making timesurfaces.");
  return new P2<TimeSurface>(minSurface,maxSurface);
}
