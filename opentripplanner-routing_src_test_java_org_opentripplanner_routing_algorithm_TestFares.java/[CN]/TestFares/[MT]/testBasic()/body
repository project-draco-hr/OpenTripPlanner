{
  GtfsContext context=GtfsLibrary.readGtfs(new File(ConstantsForTests.CALTRAIN_GTFS));
  TraverseOptions options=new TraverseOptions();
  options.setGtfsContext(context);
  Graph gg=new Graph();
  GTFSPatternHopFactory factory=new GTFSPatternHopFactory(context);
  factory.run(gg);
  ShortestPathTree spt;
  GraphPath path=null;
  long startTime=TestUtils.dateInSeconds(2009,8,7,12,0,0);
  spt=AStar.getShortestPathTree(gg,"Caltrain_Millbrae Caltrain","Caltrain_Mountain View Caltrain",startTime,options);
  path=spt.getPath(gg.getVertex("Caltrain_Mountain View Caltrain"),true);
  FareService fareService=gg.getService(FareService.class);
  Fare cost=fareService.getCost(path);
  assertEquals(cost.getFare(FareType.regular),new Money(new WrappedCurrency("USD"),425));
}
