{
  Graph gg=ConstantsForTests.getInstance().getPortlandGraph();
  TraverseOptions options=new TraverseOptions();
  options.setGtfsContext(ConstantsForTests.getInstance().getPortlandContext());
  StreetVertexIndexServiceImpl index=new StreetVertexIndexServiceImpl(gg);
  index.setup();
  ShortestPathTree spt;
  GraphPath path=null;
  long startTime=TestUtils.dateInSeconds("America/Los_Angeles",2009,11,1,12,0,0);
  spt=AStar.getShortestPathTree(gg,"TriMet_10579","TriMet_8371",startTime,options);
  path=spt.getPath(gg.getVertex("TriMet_8371"),true);
  assertNotNull(path);
  FareService fareService=gg.getService(FareService.class);
  Fare cost=fareService.getCost(path);
  assertEquals(new Money(new WrappedCurrency("USD"),200),cost.getFare(FareType.regular));
  startTime=TestUtils.dateInSeconds("America/Los_Angeles",2009,11,1,14,0,0);
  spt=AStar.getShortestPathTree(gg,"TriMet_8389","TriMet_1252",startTime,options);
  path=spt.getPath(gg.getVertex("TriMet_1252"),true);
  assertNotNull(path);
  cost=fareService.getCost(path);
  options.maxTransfers=5;
  startTime=TestUtils.dateInSeconds("America/Los_Angeles",2009,11,1,14,0,0);
  spt=AStar.getShortestPathTree(gg,"TriMet_10428","TriMet_4231",startTime,options);
  path=spt.getPath(gg.getVertex("TriMet_4231"),true);
  assertNotNull(path);
  cost=fareService.getCost(path);
}
