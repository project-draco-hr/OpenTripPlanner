{
  final Vertex v=s.getVertex();
  if (v instanceof StreetLocation)   return 0;
  if (s.getWeight() < 10 * 60)   return 0;
  int index=v.getIndex();
  if (index < weights.length) {
    double h=weights[index];
    if (s.isEverBoarded()) {
      if (localStreetService != null && v instanceof StreetVertex && s.getOptions().getMaxWalkDistance() - s.getWalkDistance() < distanceLibrary.fastDistance(v.getCoordinate(),target.getCoordinate()) && !localStreetService.transferrable(v)) {
        return Double.MAX_VALUE;
      }
      if (s.isAlightedLocal() || (!s.isOnboard() && s.getNumBoardings() > s.getOptions().getMaxTransfers())) {
        double d=distanceLibrary.fastDistance(v.getCoordinate(),target.getCoordinate());
        if (d > s.getOptions().getMaxWalkDistance() - s.getWalkDistance()) {
          return Double.MAX_VALUE;
        }
        double walk=d / s.getOptions().getRoadSpeedUpperBound();
        return Math.max(h,walk);
      }
    }
    return h;
  }
 else   return 0;
}
