{
  Dijkstra dijkstra=new Dijkstra(core,v.getVertex(),fwdOptions,u,hopLimit);
  dijkstra.setTargets(ws);
  BasicShortestPathTree spt=dijkstra.getShortestPathTree(weightLimit,nodeLimit);
  ArrayList<Shortcut> shortcuts=new ArrayList<Shortcut>();
  for (  State w : ws) {
    if (v.getVertex() == w.getVertex()) {
      continue;
    }
    double weightThroughU=v.getWeight() + w.getWeight();
    State pathAroundU=spt.getState(w.getVertex());
    if (pathAroundU == null || pathAroundU.exceedsWeightLimit(weightThroughU + .01)) {
      int timeThroughU=(int)(w.getAbsTimeDeltaSec() + v.getAbsTimeDeltaSec());
      double walkDistance=v.getWalkDistance() + w.getWalkDistance();
      Shortcut vuw=new Shortcut(v.getBackEdge(),w.getBackEdge(),timeThroughU,weightThroughU,walkDistance,mode);
      shortcuts.add(vuw);
    }
  }
  return new WitnessSearchResult(shortcuts,spt,v.getVertex(),spt.getVertexCount());
}
