{
  Vector<SPTEdge> out=new Vector<SPTEdge>();
  if (edges.size() == 0) {
    return out;
  }
  TraverseOptions options=edges.get(0).fromv.options;
  for (  SPTEdge edge : edges) {
    if (edge.payload instanceof Shortcut) {
      SPTVertex last=edge.getFromVertex();
      Shortcut shortcut=(Shortcut)edge.payload;
      for (      DirectEdge e : flatten(shortcut)) {
        SPTVertex next=new SPTVertex(e.getToVertex(),null,0,options);
        next.setParent(last,e,e);
        out.add(new SPTEdge(last,next,e,e));
        last=next;
      }
      SPTEdge lastEdge=out.lastElement();
      lastEdge.tov=edge.getToVertex();
      lastEdge.tov.setParent(edge.getFromVertex(),lastEdge.payload,lastEdge.narrative);
    }
 else {
      out.add(edge);
    }
  }
  return out;
}
