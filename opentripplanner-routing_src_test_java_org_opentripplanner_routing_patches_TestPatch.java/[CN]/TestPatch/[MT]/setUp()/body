{
  GtfsContext context=GtfsLibrary.readGtfs(new File(ConstantsForTests.FAKE_GTFS));
  options=new TraverseOptions();
  graph=new Graph();
  GTFSPatternHopFactory factory=new GTFSPatternHopFactory(context);
  factory.run(graph);
  graph.putService(CalendarServiceData.class,GtfsLibrary.createCalendarServiceData(context.getDao()));
  TransitIndexService index=new TransitIndexService(){
    @Override public PreAlightEdge getPreAlightEdge(    AgencyAndId stop){
      return (PreAlightEdge)graph.getVertex("agency_A_arrive").getOutgoing().iterator().next();
    }
    @Override public PreBoardEdge getPreBoardEdge(    AgencyAndId stop){
      return (PreBoardEdge)graph.getVertex("agency_A_depart").getIncoming().iterator().next();
    }
    @Override public RouteVariant getVariantForTrip(    AgencyAndId trip){
      return null;
    }
    @Override public List<RouteVariant> getVariantsForAgency(    String agency){
      return null;
    }
    @Override public List<RouteVariant> getVariantsForRoute(    AgencyAndId routeId){
      Route route=new Route();
      route.setId(routeId);
      route.setShortName(routeId.getId());
      PatternBoard somePatternBoard=(PatternBoard)graph.getVertex("agency_A_depart").getOutgoing().iterator().next();
      PatternHop somePatternHop=(PatternHop)somePatternBoard.getToVertex().getOutgoing().iterator().next();
      Stop stopA=somePatternHop.getStartStop();
      ArrayList<Stop> stops=new ArrayList<Stop>();
      stops.add(stopA);
      RouteVariant variant=new RouteVariant(route,stops);
      RouteSegment segment=new RouteSegment(stopA.getId());
      segment.board=somePatternBoard;
      segment.hopOut=somePatternHop;
      variant.addSegment(segment);
      ArrayList<RouteVariant> variants=new ArrayList<RouteVariant>();
      variants.add(variant);
      return variants;
    }
    @Override public List<String> getDirectionsForRoute(    AgencyAndId route){
      return Collections.emptyList();
    }
    @Override public List<TraverseMode> getAllModes(){
      return Collections.emptyList();
    }
    @Override public List<AgencyAndId> getAllRouteIds(){
      return Collections.emptyList();
    }
    @Override public void addCalendars(    Collection<ServiceCalendar> allCalendars){
    }
    @Override public void addCalendarDates(    Collection<ServiceCalendarDate> allDates){
    }
    @Override public List<String> getAllAgencies(){
      return Arrays.asList("agency");
    }
    @Override public List<ServiceCalendarDate> getCalendarDatesByAgency(    String agency){
      return null;
    }
    @Override public List<ServiceCalendar> getCalendarsByAgency(    String agency){
      return null;
    }
    @Override public Agency getAgency(    String id){
      return null;
    }
    @Override public List<AgencyAndId> getRoutesForStop(    AgencyAndId stop){
      return null;
    }
  }
;
  graph.putService(TransitIndexService.class,index);
}
