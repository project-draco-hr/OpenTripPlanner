{
  InputStream unzippedStream=new GZIPInputStream(vexStream);
  Reader decoded=new InputStreamReader(unzippedStream,Charsets.UTF_8);
  BufferedReader bufferedReader=new BufferedReader(decoded);
  ArrayList<Long> nodesInWay=new ArrayList<>();
  Way way=null;
  Relation relation=null;
  long currentWayId=-1;
  String line;
  while ((line=bufferedReader.readLine()) != null) {
    String[] fields=line.trim().split("[ \t]");
    String etype=fields[0];
    long id=Long.parseLong(fields[1]);
    if (etype.startsWith("W")) {
      if (way != null) {
        way.nodes=Longs.toArray(nodesInWay);
        ways.put(currentWayId,way);
      }
      way=new Way();
      nodesInWay.clear();
      currentWayId=id;
      if (fields.length > 2) {
        way.tags=fields[2];
      }
    }
 else     if ("N".equals(fields[0])) {
      double lat=Double.parseDouble(fields[2]);
      double lon=Double.parseDouble(fields[3]);
      Node node=new Node(lat,lon);
      if (fields.length > 4) {
        node.tags=fields[4];
      }
      nodes.put(id,node);
      nodesInWay.add(id);
    }
 else {
      LOG.error("Unrecognized entity type {}",fields[0]);
    }
  }
  bufferedReader.close();
}
