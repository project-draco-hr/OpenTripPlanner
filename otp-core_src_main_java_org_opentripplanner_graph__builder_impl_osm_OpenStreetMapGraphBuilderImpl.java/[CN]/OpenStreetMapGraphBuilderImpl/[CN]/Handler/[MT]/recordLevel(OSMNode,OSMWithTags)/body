{
  OSMLevel level=wayLevels.get(way);
  HashMap<OSMLevel,IntersectionVertex> vertices;
  long nodeId=node.getId();
  if (multiLevelNodes.containsKey(nodeId)) {
    vertices=multiLevelNodes.get(nodeId);
  }
 else {
    vertices=new HashMap<OSMLevel,IntersectionVertex>();
    multiLevelNodes.put(nodeId,vertices);
  }
  if (!vertices.containsKey(level)) {
    Coordinate coordinate=getCoordinate(node);
    String label=this.getLevelNodeLabel(node,level);
    IntersectionVertex vertex=new IntersectionVertex(graph,label,coordinate.x,coordinate.y,new NonLocalizedString(label));
    vertices.put(level,vertex);
    endpoints.add(vertex);
    return vertex;
  }
  return vertices.get(level);
}
