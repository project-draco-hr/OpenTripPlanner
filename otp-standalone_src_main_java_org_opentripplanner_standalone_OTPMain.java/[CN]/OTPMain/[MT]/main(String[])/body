{
  CommandLineParameters params=new CommandLineParameters();
  try {
    JCommander jc=new JCommander(params,args);
    if (params.help) {
      jc.setProgramName("java -Xmx[several]G -jar otp.jar");
      jc.usage();
      System.exit(0);
    }
    params.infer();
  }
 catch (  ParameterException pex) {
    LOG.error("Invalid parameter {}",pex.getMessage());
    System.exit(1);
  }
  GraphBuilderTask graphBuilder=OTPConfigurator.builderFromParameters(params);
  Graph graph=null;
  if (graphBuilder != null) {
    graphBuilder.run();
    graph=graphBuilder.getGraph();
  }
  GrizzlyServer grizzlyServer=OTPConfigurator.serverFromParameters(params,graph);
  if (grizzlyServer != null) {
    while (true) {
      try {
        grizzlyServer.run();
        return;
      }
 catch (      Throwable throwable) {
        throwable.printStackTrace();
        LOG.error("An uncaught {} occurred inside OTP. Restarting server.",throwable.getClass().getSimpleName());
      }
    }
  }
}
