{
  LOG.info("Writing GTFS table {}",tableName);
  ZipEntry zipEntry=new ZipEntry(tableName + ".txt");
  zip.putNextEntry(zipEntry);
  OutputStream protectedOut=new UncloseableOutputStream(zip);
  this.writer=new CsvWriter(protectedOut,',',Charset.forName("UTF8"));
  this.writeHeaders();
  row=0;
  Iterator<E> iter=this.iterator();
  while (iter.hasNext()) {
    if (++row % 500000 == 0) {
      LOG.info("Record number {}",human(row));
    }
    writeOneRow(iter.next());
  }
  writer.flush();
  zip.closeEntry();
  LOG.info("Wrote {} rows",human(row));
}
