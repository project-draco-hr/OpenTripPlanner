{
  Graph gg=new Graph();
  try {
    File file=new File("src/test/resources/simple_streets/simple_streets.shp");
    DataStore dataStore=new ShapefileDataStore(file.toURI().toURL());
    String[] typeNames=dataStore.getTypeNames();
    String typeName=typeNames[0];
    FeatureSource<SimpleFeatureType,SimpleFeature> featureSource;
    featureSource=dataStore.getFeatureSource(typeName);
    ShapefileStreetLoader loader=new ShapefileStreetLoader(gg,featureSource);
    loader.load();
  }
 catch (  Exception e) {
    e.printStackTrace();
    assertNull("got an exception");
  }
  SpatialVertex northVertex=null;
  for (  Vertex v : gg.getVertices()) {
    if (v instanceof SpatialVertex) {
      SpatialVertex sv=(SpatialVertex)v;
      if (northVertex == null || sv.getCoordinate().y > northVertex.getCoordinate().y) {
        northVertex=sv;
      }
    }
  }
  assertNotNull(northVertex);
  SpatialVertex eastVertex=null;
  for (  Vertex v : gg.getVertices()) {
    if (v instanceof SpatialVertex) {
      SpatialVertex sv=(SpatialVertex)v;
      if (eastVertex == null || sv.getCoordinate().x > eastVertex.getCoordinate().x) {
        eastVertex=sv;
      }
    }
  }
  assertNotNull(eastVertex);
  ShortestPathTree spt=Dijkstra.getShortestPathTree(gg,northVertex.label,eastVertex.label,new State(new GregorianCalendar(2009,8,7,12,0,0).getTimeInMillis()),new WalkOptions());
  GraphPath path=spt.getPath(eastVertex);
  assertNotNull(path);
  Narrative narrative=new Narrative(path);
  assertEquals(1,narrative.getSections().size());
  NarrativeSection walkSection=narrative.getSections().firstElement();
  assertEquals(2,walkSection.getItems().size());
  Geometry g=walkSection.getGeometry();
  Coordinate[] coords=g.getCoordinates();
  assertTrue(coords[0].distance(northVertex.getCoordinate()) < 0.0000001);
  assertTrue(coords[coords.length - 1].distance(eastVertex.getCoordinate()) < 0.0000001);
}
