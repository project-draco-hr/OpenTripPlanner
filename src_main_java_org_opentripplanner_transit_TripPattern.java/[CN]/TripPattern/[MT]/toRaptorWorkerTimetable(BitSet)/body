{
  List<TripSchedule> activeSchedules=new ArrayList<>();
  for (  TripSchedule schedule : tripSchedules) {
    if (servicesActive.get(schedule.serviceCode)) {
      activeSchedules.add(schedule);
    }
  }
  RaptorWorkerTimetable timetable=new RaptorWorkerTimetable(activeSchedules.size(),stops.length);
  int i=0;
  for (  TripSchedule schedule : activeSchedules) {
    timetable.timesPerTrip[i]=schedule.departures;
  }
  timetable.stopIndices=this.stops;
  return timetable;
}
