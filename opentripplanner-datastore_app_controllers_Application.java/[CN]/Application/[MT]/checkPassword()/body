{
  request.user=null;
  String username=params.get("userName");
  String password=params.get("password");
  User user=getUser(username);
  if (user == null) {
    Logger.debug("no user by this username: %s (count = %s)",username,User.count());
    forbidden();
  }
  if (user.checkPassword(password)) {
    request.user=username;
    Logger.debug("Logged in %s",user.userName);
  }
 else {
    Logger.debug("bad password");
    forbidden();
  }
}
