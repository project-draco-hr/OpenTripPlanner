{
  try {
    DocumentBuilder builder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
    Document doc=builder.parse(in);
    processDocument(doc,map,false);
    map.secondPhase();
    processDocument(doc,map,true);
  }
 catch (  ParserConfigurationException e) {
    throw new RuntimeException(e);
  }
}
