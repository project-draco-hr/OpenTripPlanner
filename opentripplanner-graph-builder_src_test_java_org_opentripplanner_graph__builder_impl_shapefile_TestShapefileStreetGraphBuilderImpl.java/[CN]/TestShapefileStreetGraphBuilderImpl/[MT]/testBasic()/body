{
  Graph gg=new Graph();
  File file=new File("src/test/resources/nyc_streets/streets.shp");
  if (!file.exists()) {
    System.out.println("No New York City basemap; skipping; see comment here for details");
    return;
  }
  ShapefileFeatureSourceFactoryImpl factory=new ShapefileFeatureSourceFactoryImpl(file);
  ShapefileStreetSchema schema=new ShapefileStreetSchema();
  schema.setIdAttribute("StreetCode");
  schema.setNameAttribute("Street");
  CaseBasedTraversalPermissionConverter reverse=new CaseBasedTraversalPermissionConverter("TrafDir",StreetTraversalPermission.PEDESTRIAN_AND_BICYCLE_ONLY);
  CaseBasedTraversalPermissionConverter forward=new CaseBasedTraversalPermissionConverter("TrafDir",StreetTraversalPermission.PEDESTRIAN_AND_BICYCLE_ONLY);
  forward.addPermission("W",StreetTraversalPermission.ALL);
  reverse.addPermission("W",StreetTraversalPermission.PEDESTRIAN_ONLY);
  forward.addPermission("A",StreetTraversalPermission.PEDESTRIAN_ONLY);
  reverse.addPermission("A",StreetTraversalPermission.ALL);
  forward.addPermission("T",StreetTraversalPermission.ALL);
  reverse.addPermission("T",StreetTraversalPermission.ALL);
  schema.setForwardPermissionConverter(forward);
  schema.setReversePermissionConverter(reverse);
  ShapefileStreetGraphBuilderImpl loader=new ShapefileStreetGraphBuilderImpl();
  loader.setFeatureSourceFactory(factory);
  loader.setSchema(schema);
  loader.buildGraph(gg);
  assertEquals(104910,gg.getVertices().size());
  Vertex start=gg.getVertex("PARK PL at VANDERBILT AV");
  Vertex end=gg.getVertex("GRAND ST at LAFAYETTE ST");
  assertNotNull(start);
  assertNotNull(end);
}
