{
  long beginPropagationTime=System.currentTimeMillis();
  for (int s=allStopsTouched.nextSetBit(0); s >= 0; s=allStopsTouched.nextSetBit(s + 1)) {
    int baseTimeSeconds=timesAtTransitStops[s];
    if (baseTimeSeconds != UNREACHED) {
      baseTimeSeconds-=departureTime;
      int[] targets=data.targetsForStop.get(s);
      if (targets == null)       continue;
      for (int i=0; i < targets.length; i++) {
        int targetIndex=targets[i++];
        int distance=targets[i];
        int egressWalkTimeSeconds=(int)(distance / req.walkSpeed);
        int propagated_time=baseTimeSeconds + egressWalkTimeSeconds;
        if (propagated_time < 0) {
          throw new RuntimeException("Reached a destination in negative time, this cannot happen!");
        }
        if (timesAtTargets[targetIndex] > propagated_time) {
          timesAtTargets[targetIndex]=propagated_time;
        }
      }
    }
  }
  totalPropagationTime+=(System.currentTimeMillis() - beginPropagationTime);
}
