{
  patternsTouched.clear();
  for (int stop=stopsTouched.nextSetBit(0); stop >= 0; stop=stopsTouched.nextSetBit(stop + 1)) {
    markPatternsForStop(stop);
    int fromTime=bestTimes[stop];
    TIntIterator transferIterator=data.transfersForStop.rowIterator(stop);
    while (transferIterator.hasNext()) {
      int toStop=transferIterator.next();
      int distance=transferIterator.next();
      int toTime=fromTime + distance;
      if (toTime < max_time && toTime < bestTimes[toStop]) {
        bestTimes[toStop]=toTime;
        markPatternsForStop(toStop);
      }
    }
  }
}
