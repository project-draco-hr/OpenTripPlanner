{
  long beginCalcTime=System.currentTimeMillis();
  long totalPropagationTime=0;
  TIntIntMap initialStops=new TIntIntHashMap();
  TObjectIntIterator<TransitStop> initialIterator=accessTimes.iterator();
  while (initialIterator.hasNext()) {
    initialIterator.advance();
    TransitStop tstop=initialIterator.key();
    int accessTime=initialIterator.value();
    int stopIndex=data.indexForStop.get(tstop.getStop());
    if (stopIndex == -1) {
      continue;
    }
    initialStops.put(stopIndex,accessTime);
  }
  PropagatedTimesStore propagatedTimesStore=new PropagatedTimesStore(graph);
  Contiguous2DIntArray vTimes=new Contiguous2DIntArray(60,StreetVertex.getMaxIndex());
  for (int departureTime=9 * 60 * 60 - 60, n=0; departureTime >= 8 * 60 * 60; departureTime-=60, n++) {
    if (n % 15 == 0) {
      LOG.info("minute {}",n);
    }
    this.runRaptor(initialStops,departureTime);
    long beginPropagationTime=System.currentTimeMillis();
    for (int s=0; s < data.nStops; s++) {
      int baseTimeSeconds=bestTimes[s];
      if (baseTimeSeconds != UNREACHED) {
        baseTimeSeconds-=departureTime;
        TIntIterator intersectionIterator=data.targetsForStop.rowIterator(s);
        while (intersectionIterator.hasNext()) {
          int streetVertexIndex=intersectionIterator.next();
          int distance=intersectionIterator.next();
          int egressWalkTimeSeconds=distance;
          int propagated_time=baseTimeSeconds + egressWalkTimeSeconds;
          vTimes.setIfLess(n,streetVertexIndex,propagated_time);
        }
      }
    }
    totalPropagationTime+=(System.currentTimeMillis() - beginPropagationTime);
  }
  long calcTime=System.currentTimeMillis() - beginCalcTime;
  LOG.info("calc time {}sec",calcTime / 1000.0);
  LOG.info("  propagation {}sec",totalPropagationTime / 1000.0);
  LOG.info("  raptor {}sec",(calcTime - totalPropagationTime) / 1000.0);
  vTimes.dumpVariableByte();
  propagatedTimesStore.setFromBytes(vTimes);
  return propagatedTimesStore;
}
