{
  ZMsg msg=ZMsg.recvMsg(subscriber);
  if (msg == null) {
    LOG.warn("ZMQ received null message.");
    return null;
  }
  List<Update> ret=null;
  try {
    Iterator<ZFrame> frames=msg.iterator();
    frames.next();
    ByteArrayOutputStream buffer=new ByteArrayOutputStream();
    while (frames.hasNext()) {
      ZFrame frame=frames.next();
      byte[] frameData=frame.getData();
      buffer.write(frameData);
    }
    if (buffer.size() == 0) {
      LOG.debug("received 0-length CTX message {}",msg);
      return null;
    }
    InputStream gzippedMessageStream=new ByteArrayInputStream(buffer.toByteArray());
    InputStream messageStream=new GZIPInputStream(gzippedMessageStream);
    buffer.reset();
    byte[] b=new byte[4096];
    for (int n; (n=messageStream.read(b)) != -1; ) {
      buffer.write(b,0,n);
    }
    if (logWriter != null) {
      logWriter.write(buffer.toString());
      logWriter.append('\n');
    }
    ret=parseCTX(buffer.toString());
    count+=1;
    LOG.debug("decoded gzipped CTX message #{}: {}",count,msg);
    if (count % 1000 == 0) {
      LOG.info("received {} KV8 messages.",count);
    }
  }
 catch (  Exception e) {
    LOG.error("exception while decoding (unzipping) incoming CTX message: {}",e.getMessage());
  }
 finally {
    msg.destroy();
  }
  return ret;
}
