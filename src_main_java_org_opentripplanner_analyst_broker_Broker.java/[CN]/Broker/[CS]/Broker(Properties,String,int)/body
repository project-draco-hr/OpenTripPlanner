{
  this.config=brokerConfig;
  workerConfig=new Properties();
  workerConfig.setProperty("broker-address",addr);
  workerConfig.setProperty("broker-port","" + port);
  if (brokerConfig.getProperty("statistics-queue") != null)   workerConfig.setProperty("statistics-queue",brokerConfig.getProperty("statistics-queue"));
  workerConfig.setProperty("graphs-bucket",brokerConfig.getProperty("graphs-bucket"));
  workerConfig.setProperty("pointsets-bucket",brokerConfig.getProperty("pointsets-bucket"));
  workerConfig.setProperty("auto-shutdown","true");
  Boolean workOffline=Boolean.parseBoolean(brokerConfig.getProperty("work-offline"));
  if (workOffline == null)   workOffline=true;
  this.workOffline=workOffline;
  workerName=brokerConfig.getProperty("worker-name") != null ? brokerConfig.getProperty("worker-name") : "analyst-worker";
  project=brokerConfig.getProperty("project") != null ? brokerConfig.getProperty("project") : "analyst";
  this.maxWorkers=brokerConfig.getProperty("max-workers") != null ? Integer.parseInt(brokerConfig.getProperty("max-workers")) : 4;
  ec2=new AmazonEC2Client();
}
