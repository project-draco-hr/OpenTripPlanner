{
  routerId=spt.getOptions().routerId;
  long t0=System.currentTimeMillis();
  times=new int[Vertex.getMaxIndex()];
  Arrays.fill(times,UNREACHABLE);
  for (  State state : spt.getAllStates()) {
    Vertex vertex=state.getVertex();
    if (vertex instanceof StreetVertex || vertex instanceof TransitStop) {
      int i=vertex.getIndex();
      int t=(int)state.getActiveTime();
      if (times[i] == UNREACHABLE || times[i] > t) {
        times[i]=t;
      }
    }
  }
  GenericLocation from=spt.getOptions().getFrom();
  this.lon=from.getLng();
  this.lat=from.getLat();
  this.id=makeUniqueId();
  this.dateTime=spt.getOptions().dateTime;
  long t1=System.currentTimeMillis();
  LOG.info("Made TimeSurface from SPT in {} msec.",(int)(t1 - t0));
  makeSampleGrid(spt);
}
