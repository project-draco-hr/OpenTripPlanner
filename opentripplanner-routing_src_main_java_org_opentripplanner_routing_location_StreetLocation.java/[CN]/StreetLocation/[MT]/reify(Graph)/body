{
  if (streets == null)   return;
  Vertex v1=null, v2=null;
  for (  Street e : streets) {
    if (v1 == null && v2 != e.getToVertex()) {
      v1=e.getToVertex();
    }
 else     if (v1 == null && v2 != e.getFromVertex()) {
      v1=e.getFromVertex();
    }
    if (v2 == null && v1 != e.getToVertex()) {
      v2=e.getToVertex();
    }
 else     if (v2 == null && v1 != e.getFromVertex()) {
      v2=e.getFromVertex();
    }
  }
  for (  Edge e : getIncoming()) {
    if (!(e instanceof Street))     continue;
    Street s=(Street)e;
    Vertex intersection=s.getFromVertex();
    if (intersection != v1 && intersection != v2)     continue;
    if (intersection instanceof IntersectionVertex) {
      ((IntersectionVertex)intersection).outStreet=s;
    }
 else     if (intersection instanceof DeadEnd) {
      ((DeadEnd)intersection).outStreet=s;
    }
 else {
      GenericVertex v=(GenericVertex)intersection;
      Vector<Edge> outgoing=v.getOutgoing();
      Iterator<Edge> it=outgoing.iterator();
      Vertex otherEnd=intersection == v1 ? v2 : v1;
      while (it.hasNext()) {
        Edge e2=it.next();
        if (e2.getToVertex() == otherEnd) {
          it.remove();
        }
      }
      outgoing.add(e);
      v.setIncoming(outgoing);
    }
  }
  for (  Edge e : getOutgoing()) {
    if (!(e instanceof Street))     continue;
    Street s=(Street)e;
    Vertex intersection=s.getToVertex();
    if (intersection != v1 && intersection != v2)     continue;
    if (intersection instanceof IntersectionVertex) {
      ((IntersectionVertex)intersection).inStreet=s;
    }
 else     if (intersection instanceof DeadEnd) {
      ((DeadEnd)intersection).inStreet=s;
    }
 else {
      GenericVertex v=(GenericVertex)intersection;
      Vector<Edge> incoming=v.getIncoming();
      Iterator<Edge> it=incoming.iterator();
      Vertex otherEnd=intersection == v1 ? v2 : v1;
      while (it.hasNext()) {
        Edge e2=it.next();
        if (e2.getFromVertex() == otherEnd) {
          it.remove();
        }
      }
      incoming.add(e);
      v.setOutgoing(incoming);
    }
  }
  graph.addVertex(this);
  location=null;
}
