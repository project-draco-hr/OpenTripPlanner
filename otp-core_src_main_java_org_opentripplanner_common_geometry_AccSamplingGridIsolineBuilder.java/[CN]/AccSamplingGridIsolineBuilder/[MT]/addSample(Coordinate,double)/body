{
  if (closed) {
    throw new IllegalStateException("Cannot add sample once an isochrone is computed.");
  }
  int[] xy=sampleGrid.getLowerLeftIndex(C0);
  int x=xy[0];
  int y=xy[1];
  @SuppressWarnings("unchecked") ZSamplePoint<TZ>[] ABCD=new ZSamplePoint[4];
  ABCD[0]=sampleGrid.getOrCreate(x,y);
  ABCD[1]=sampleGrid.getOrCreate(x + 1,y);
  ABCD[2]=sampleGrid.getOrCreate(x,y + 1);
  ABCD[3]=sampleGrid.getOrCreate(x + 1,y + 1);
  for (  ZSamplePoint<TZ> P : ABCD) {
    if (P.getUserData() == null)     P.setUserData(new IsoLineUserData());
    Coordinate C=sampleGrid.getCoordinates(P);
    P.setZ(zFunc.cumulateSample(C0,C,z,P.getZ()));
  }
}
