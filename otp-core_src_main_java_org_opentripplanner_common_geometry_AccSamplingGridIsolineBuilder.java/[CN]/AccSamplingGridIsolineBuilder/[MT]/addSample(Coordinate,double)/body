{
  if (closed) {
    throw new IllegalStateException("Cannot add sample once an isochrone is computed.");
  }
  XYIndex iA=getLowerLeftIndex(C0);
  GridSample[] ABCD=new GridSample[4];
  ABCD[0]=getOrCreateSample(iA);
  ABCD[1]=ABCD[0].right != null ? ABCD[0].right : getOrCreateSample(iA.translated(1,0));
  ABCD[2]=ABCD[0].up != null ? ABCD[0].up : getOrCreateSample(iA.translated(0,1));
  ABCD[3]=ABCD[1].up != null ? ABCD[1].up : getOrCreateSample(iA.translated(1,1));
  for (  GridSample P : ABCD) {
    Coordinate C=getCoordinate(P.index);
    P.zz=zFunc.cumulateSample(C0,C,z,P.zz);
  }
}
