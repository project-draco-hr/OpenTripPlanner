{
  preference=pref;
  edge=e;
  edgeCoords=e.getGeometry().getCoordinateSequence();
  numEdgeCoords=edgeCoords.size();
  nearestPointOnEdge=new Coordinate();
  distance=calcNearestPoint(loc.getCoordinate());
  endwiseVertex=calcEndwiseVertex();
  int edgeSegmentIndex=nearestSegmentIndex;
  Coordinate c0=edgeCoords.getCoordinate(edgeSegmentIndex);
  Coordinate c1=edgeCoords.getCoordinate(edgeSegmentIndex + 1);
  directionOfEdge=DirectionUtils.getAzimuth(c0,c1);
  directionToEdge=DirectionUtils.getAzimuth(nearestPointOnEdge,loc.getCoordinate());
  heading=loc.heading;
  if (heading != null) {
    double absDiff=Math.abs(heading - directionOfEdge);
    directionDifference=Math.min(MAX_ABS_DIRECTION_DIFFERENCE - absDiff,absDiff);
  }
  score=calcScore(mode);
}
