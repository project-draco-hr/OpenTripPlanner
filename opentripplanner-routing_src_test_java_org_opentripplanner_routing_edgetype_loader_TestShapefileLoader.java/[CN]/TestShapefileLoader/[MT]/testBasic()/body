{
  Graph gg=new Graph();
  File file=new File("src/test/resources/nyc_streets/streets.shp");
  if (!file.exists()) {
    System.out.println("No New York City basemap; skipping; see comment here for details");
    return;
  }
  ShapefileDataStore dataStore=new ShapefileDataStore(file.toURI().toURL());
  String typeNames[]=dataStore.getTypeNames();
  String typeName=typeNames[0];
  FeatureSource<SimpleFeatureType,SimpleFeature> featureSource;
  featureSource=dataStore.getFeatureSource(typeName);
  ShapefileStreetLoader loader=new ShapefileStreetLoader(gg,featureSource);
  loader.load();
  System.out.println("vertices: " + gg.getVertices().size());
  GtfsContext context=GtfsLibrary.readGtfs(new File(ConstantsForTests.NY_GTFS));
  GTFSPatternHopLoader hl=new GTFSPatternHopLoader(gg,context);
  hl.load();
  NetworkLinker nl=new NetworkLinker(gg);
  nl.createLinkage();
  System.out.println("vertices: " + gg.getVertices().size());
  Vertex start=gg.getVertex("PARK PL at VANDERBILT AV");
  Vertex end=gg.getVertex("GRAND ST at LAFAYETTE ST");
  assertNotNull(start);
  assertNotNull(end);
  ShortestPathTree spt=Dijkstra.getShortestPathTree(gg,start.getLabel(),end.getLabel(),new State(new GregorianCalendar(2009,8,7,12,2,0).getTimeInMillis()),new TraverseOptions(context));
  GraphPath path=spt.getPath(end);
  assertNotNull(path);
}
