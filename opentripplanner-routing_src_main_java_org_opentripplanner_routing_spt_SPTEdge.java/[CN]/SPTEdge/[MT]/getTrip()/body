{
  if (payload instanceof Board || payload instanceof Hop || payload instanceof Alight) {
    return narrative.getTrip();
  }
  int patternIndex=-1;
  if (payload instanceof PatternAlight) {
    patternIndex=fromv.state.getData().getTrip();
  }
 else   if (payload instanceof PatternEdge) {
    patternIndex=tov.state.getData().getTrip();
  }
 else {
    return null;
  }
  TripPattern pattern=((PatternEdge)payload).getPattern();
  return pattern.getTrip(patternIndex);
}
