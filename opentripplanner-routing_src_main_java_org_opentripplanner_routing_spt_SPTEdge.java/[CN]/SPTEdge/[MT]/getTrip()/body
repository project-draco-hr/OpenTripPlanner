{
  if (payload instanceof Board || payload instanceof Hop || payload instanceof Alight) {
    return payload.getTrip();
  }
  if (payload instanceof PatternEdge) {
    int patternIndex=fromv.state.getTrip();
    if (patternIndex == -1) {
      patternIndex=tov.state.getTrip();
    }
    TripPattern pattern=((PatternEdge)payload).getPattern();
    return pattern.getTrip(patternIndex);
  }
  return null;
}
