{
  context=GtfsLibrary.readGtfs(new File(ConstantsForTests.FAKE_GTFS));
  graph=new Graph();
  GTFSPatternHopFactory factory=new GTFSPatternHopFactory(context);
  factory.run(graph);
  graph.putService(CalendarServiceData.class,GtfsLibrary.createCalendarServiceData(context.getDao()));
  String[] stops={"agency:A","agency:B","agency:C","agency:D","agency:E"};
  for (int i=0; i < stops.length; ++i) {
    TransitStop stop=(TransitStop)(graph.getVertex(stops[i]));
    IntersectionVertex front=new IntersectionVertex(graph,"near_1_" + stop.getStopId(),stop.getX() + 0.0001,stop.getY() + 0.0001);
    IntersectionVertex back=new IntersectionVertex(graph,"near_2_" + stop.getStopId(),stop.getX() - 0.0001,stop.getY() - 0.0001);
    StreetEdge street1=new StreetEdge(front,back,GeometryUtils.makeLineString(stop.getX() + 0.0001,stop.getY() + 0.0001,stop.getX() - 0.0001,stop.getY() - 0.0001),"street",100,StreetTraversalPermission.ALL,false);
    StreetEdge street2=new StreetEdge(back,front,GeometryUtils.makeLineString(stop.getX() - 0.0001,stop.getY() - 0.0001,stop.getX() + 0.0001,stop.getY() + 0.0001),"street",100,StreetTraversalPermission.ALL,true);
  }
  TransitToStreetNetworkModule ttsnm=new TransitToStreetNetworkModule();
  graph.hasStreets=true;
  graph.hasTransit=true;
  ttsnm.buildGraph(graph,new HashMap<Class<?>,Object>());
}
