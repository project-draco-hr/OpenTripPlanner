{
  vertexIndex=new STRtree();
  edgeIndex=new STRtree();
  Envelope env;
  for (  Vertex v : graph.getVertices()) {
    Coordinate c=v.getCoordinate();
    env=new Envelope(c);
    vertexIndex.insert(env,v);
    for (    DirectEdge e : IterableLibrary.filter(v.getOutgoing(),DirectEdge.class)) {
      if (e.getGeometry() == null)       continue;
      if (e instanceof PatternEdge || e instanceof StreetTransitLink || e instanceof StreetEdge) {
        env=e.getGeometry().getEnvelopeInternal();
        edgeIndex.insert(env,e);
      }
    }
  }
  vertexIndex.build();
  edgeIndex.build();
}
