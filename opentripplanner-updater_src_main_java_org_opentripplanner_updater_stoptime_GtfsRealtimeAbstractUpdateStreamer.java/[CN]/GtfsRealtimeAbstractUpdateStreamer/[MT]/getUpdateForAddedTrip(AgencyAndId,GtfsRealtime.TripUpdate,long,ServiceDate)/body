{
  Trip trip=new Trip();
  trip.setId(tripId);
  Route route=new Route();
  AgencyAndId routeId=new AgencyAndId(defaultAgencyId,tripUpdate.getTrip().getRouteId());
  route.setId(routeId);
  trip.setRoute(route);
  long today=serviceDate.getAsDate(TimeZone.getTimeZone("GMT")).getTime() / 1000;
  List<Update> updates=new LinkedList<Update>();
  for (  StopTimeUpdate stopTimeUpdate : tripUpdate.getStopTimeUpdateList()) {
    AgencyAndId stopId=new AgencyAndId(defaultAgencyId,stopTimeUpdate.getStopId());
    long arrivalTime=stopTimeUpdate.getArrival().getTime();
    long departureTime=stopTimeUpdate.getDeparture().getTime();
    arrivalTime=arrivalTime - today;
    departureTime=departureTime - today;
    Update u=new Update(tripId,stopId,stopTimeUpdate.getStopSequence(),(int)arrivalTime,(int)departureTime,Update.Status.PREDICTION,timestamp,serviceDate);
    updates.add(u);
  }
  return TripUpdate.forAddedTrip(trip,timestamp,serviceDate,updates);
}
