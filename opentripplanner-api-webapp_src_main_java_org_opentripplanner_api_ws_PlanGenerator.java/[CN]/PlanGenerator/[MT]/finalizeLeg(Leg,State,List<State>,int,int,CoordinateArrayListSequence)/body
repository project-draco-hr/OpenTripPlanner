{
  if (start != -1) {
    leg.walkSteps=getWalkSteps(states.subList(start,end + 1));
  }
  leg.endTime=makeCalendar(state.getBackState());
  Geometry geometry=GeometryUtils.getGeometryFactory().createLineString(coordinates);
  leg.legGeometry=PolylineEncoder.createEncodings(geometry);
  Edge backEdge=state.getBackEdge();
  String name;
  if (backEdge instanceof StreetEdge) {
    name=backEdge.getName();
  }
 else {
    name=state.getVertex().getName();
  }
  leg.to=makePlace(state,name,true);
  coordinates.clear();
}
