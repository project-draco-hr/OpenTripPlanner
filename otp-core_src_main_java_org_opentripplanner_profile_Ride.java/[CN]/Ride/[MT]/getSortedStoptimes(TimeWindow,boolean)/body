{
  List<Integer> times=Lists.newArrayList();
  for (  PatternRide patternRide : patternRides) {
    for (    TripTimes tt : patternRide.pattern.getScheduledTimetable().getTripTimes()) {
      if (window.servicesRunning.get(tt.serviceCode)) {
        int t=arrivals ? tt.getArrivalTime(patternRide.toIndex - 1) : tt.getDepartureTime(patternRide.fromIndex);
        if (window.includes(t))         times.add(t);
      }
    }
  }
  Collections.sort(times);
  return times;
}
