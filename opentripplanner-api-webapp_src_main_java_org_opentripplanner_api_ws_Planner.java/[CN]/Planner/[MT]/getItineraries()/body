{
  Response response=new Response(httpServletRequest);
  TraverseOptions request=null;
  try {
    request=buildRequest();
    TripPlan plan=planGenerator.generate(request);
    response.setPlan(plan);
  }
 catch (  Exception e) {
    PlannerError error=new PlannerError(e);
    response.setError(error);
  }
 finally {
    if (request != null && request.rctx != null) {
      int nRemoved=request.rctx.destroy();
      LOG.debug("routing context destroyed ({} temporary edges removed)",nRemoved);
    }
  }
  return response;
}
