{
  Request request=new Request();
  request.setFrom(fromPlace);
  request.setTo(toPlace);
  request.setDateTime(date,time);
  if (max != null)   request.setNumItineraries(max);
  if (maxWalkDistance != null)   request.setWalk(maxWalkDistance);
  if (arriveBy != null && arriveBy)   request.setArriveBy(true);
  request.setOptimize(optimize);
  request.setModes(modes);
  request.setOutputFormat(MediaType.valueOf(outputFormat));
  TripPlan plan=generatePlan(request);
  Response response=new Response(request,plan);
  return response;
}
