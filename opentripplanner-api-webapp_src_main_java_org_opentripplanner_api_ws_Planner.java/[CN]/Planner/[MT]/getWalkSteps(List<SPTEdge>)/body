{
  List<WalkStep> steps=new ArrayList<WalkStep>();
  WalkStep step=null;
  double lastAngle=0;
  for (  SPTEdge sptEdge : edges) {
    Edge edge=sptEdge.payload;
    String streetName=edge.getName();
    if (step == null) {
      step=new WalkStep();
      steps.add(step);
      step.absoluteDirection=edge.getDirection();
      step.streetName=streetName;
    }
 else     if (!step.streetName.equals(streetName)) {
      step=new WalkStep();
      steps.add(step);
      step.absoluteDirection=edge.getDirection();
      step.streetName=streetName;
      double thisAngle=getFirstAngle(edge.getGeometry());
      step.setRelativeDirection(lastAngle,thisAngle);
    }
 else {
      double thisAngle=getFirstAngle(edge.getGeometry());
      RelativeDirection direction=WalkStep.getRelativeDirection(lastAngle,thisAngle);
      if (direction != RelativeDirection.CONTINUE) {
        Vertex start=edge.getFromVertex();
        boolean foundAlternatePaths=false;
        for (        Edge out : start.getOutgoing()) {
          if (out == edge) {
            continue;
          }
          if (!(out instanceof Street)) {
            continue;
          }
          foundAlternatePaths=true;
          break;
        }
        if (foundAlternatePaths) {
          step=new WalkStep();
          steps.add(step);
          step.absoluteDirection=edge.getDirection();
          step.streetName=streetName;
          step.relativeDirection=direction;
          step.stayOn=true;
        }
      }
    }
    step.distance+=edge.getDistance();
    lastAngle=getLastAngle(edge.getGeometry());
  }
  return steps;
}
