{
  if (!state.isEverBoarded()) {
    return 0;
  }
  TransferTable transferTable=state.getOptions().getRoutingContext().transferTable;
  int transferTime=transferTable.getTransferTime(state.getPreviousStop(),currentStop,state.getPreviousTrip(),trip,boarding);
  if (state.getBackEdge() instanceof TimedTransferEdge) {
    if (transferTime != StopTransfer.TIMED_TRANSFER) {
      return -1;
    }
  }
  if (transferTime == StopTransfer.UNKNOWN_TRANSFER) {
    return 0;
  }
  if (transferTime == StopTransfer.FORBIDDEN_TRANSFER) {
    return -1;
  }
  return transferTime;
}
