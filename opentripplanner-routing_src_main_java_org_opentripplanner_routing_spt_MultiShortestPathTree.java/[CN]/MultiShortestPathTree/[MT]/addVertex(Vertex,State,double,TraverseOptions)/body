{
  Collection<SPTVertex> vertices=vertexSets.get(vertex);
  if (vertices == null) {
    vertices=new ArrayList<SPTVertex>();
    vertexSets.put(vertex,vertices);
    SPTVertex ret=new SPTVertex(vertex,state,weightSum,options);
    vertices.add(ret);
    return ret;
  }
  long duration=Math.abs(state.getTime() - state.getStartTime());
  Iterator<SPTVertex> it=vertices.iterator();
  while (it.hasNext()) {
    SPTVertex v=it.next();
    double old_w=v.weightSum;
    long old_duration=Math.abs(v.state.getTime() - v.state.getStartTime());
    if (old_w <= weightSum && old_duration <= duration) {
      return null;
    }
    if (old_w > weightSum && old_duration > duration) {
      it.remove();
    }
  }
  SPTVertex ret=new SPTVertex(vertex,state,weightSum,options);
  vertices.add(ret);
  return ret;
}
