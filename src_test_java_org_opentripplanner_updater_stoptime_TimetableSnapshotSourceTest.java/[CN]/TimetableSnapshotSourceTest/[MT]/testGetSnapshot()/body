{
  updater.applyTripUpdates(graph,fullDataset,Arrays.asList(TripUpdate.parseFrom(cancellation)),"agency");
  TimetableSnapshot snapshot=updater.getTimetableSnapshot();
  assertNotNull(snapshot);
  assertSame(snapshot,updater.getTimetableSnapshot());
  updater.applyTripUpdates(graph,fullDataset,Arrays.asList(TripUpdate.parseFrom(cancellation)),"agency");
  assertSame(snapshot,updater.getTimetableSnapshot());
  updater.maxSnapshotFrequency=(-1);
  TimetableSnapshot newSnapshot=updater.getTimetableSnapshot();
  assertNotNull(newSnapshot);
  assertNotSame(snapshot,newSnapshot);
}
