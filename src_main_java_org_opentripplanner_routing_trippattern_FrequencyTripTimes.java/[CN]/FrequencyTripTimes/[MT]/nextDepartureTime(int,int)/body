{
  if (t > endTime)   return -1;
  int stopOffset=getDepartureTime(hop) - getDepartureTime(0);
  int beg=startTime + stopOffset;
  int end=endTime + stopOffset;
  if (exactTimes) {
    for (int dep=beg; dep < end; dep+=headwaySecs) {
      if (dep >= t)       return dep;
    }
  }
 else {
    int dep=t + headwaySecs;
    if (dep < beg)     return beg;
    if (dep < end)     return dep;
  }
  return -1;
}
