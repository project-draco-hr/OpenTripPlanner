{
  Envelope envelope=new Envelope(c);
  List<Vertex> nearby=new LinkedList<Vertex>();
  int i=0;
  double envelopeGrowthRate=0.0018;
  while (nearby.size() < 2 && i < 10) {
    ++i;
    envelope.expandBy(envelopeGrowthRate);
    envelopeGrowthRate*=2;
    nearby=intersections.query(envelope);
    Collections.sort(nearby,new Comparator<Vertex>(){
      public int compare(      Vertex a,      Vertex b){
        double distance=(a.distance(c) - b.distance(c));
        return (int)(Math.abs(distance) / distance);
      }
    }
);
    for (    Vertex a : nearby) {
      for (      Vertex b : nearby) {
        if (a == b) {
          continue;
        }
        Edge street=getEdgeWithToVertex(a,b);
        if (street != null) {
          LineString g=(LineString)street.getGeometry();
          GeometryFactory factory=new GeometryFactory();
          if (g.distance(factory.createPoint(c)) < 0.00000001) {
            LengthIndexedLine l=new LengthIndexedLine(g);
            double location=l.indexOf(c);
            return new StreetLocation(street,location,incoming);
          }
        }
      }
    }
  }
  throw new IntersectionNotFoundException("No intersection found near " + c + " within envelope "+ envelope);
}
