{
  CalendarServiceData data=graph.getService(CalendarServiceData.class);
  AgencyAndId serviceId=new AgencyAndId("A","test2");
  TimeZone timezone=data.getTimeZoneForAgencyId("agency");
  LocalizedServiceId lServiceId=new LocalizedServiceId(serviceId,timezone);
  ServiceDate date=new ServiceDate();
  ServiceDate other=date.next();
  assertTrue(updater.addService(serviceId,timezone,Collections.singletonList(date)));
  assertTrue(data.getLocalizedServiceIds().contains(lServiceId));
  assertTrue(data.getServiceIdsForDate(date).contains(serviceId));
  assertEquals(1,data.getServiceDatesForServiceId(serviceId).size());
  assertEquals(date,data.getServiceDatesForServiceId(serviceId).get(0));
  assertFalse(updater.addService(serviceId,timezone,Collections.singletonList(other)));
  assertTrue(data.getLocalizedServiceIds().contains(lServiceId));
  assertTrue(data.getServiceIdsForDate(date).contains(serviceId));
  assertEquals(1,data.getServiceDatesForServiceId(serviceId).size());
  assertEquals(date,data.getServiceDatesForServiceId(serviceId).get(0));
}
