{
  initIndexes();
  Envelope envelope=getEnvelope(lowerLeft,upperRight);
  @SuppressWarnings("unchecked") List<Vertex> query=vertexIndex.query(envelope);
  if (pointsOnly) {
    SimpleVertexSet out=new SimpleVertexSet();
    out.vertices=new ArrayList<SimpleVertex>(query.size());
    for (    Vertex v : query) {
      out.vertices.add(new SimpleVertex(v));
    }
    return out;
  }
 else {
    VertexSet out=new VertexSet();
    out.vertices=query;
    Graph graph=graphService.getGraph();
    return out.withGraph(graph);
  }
}
