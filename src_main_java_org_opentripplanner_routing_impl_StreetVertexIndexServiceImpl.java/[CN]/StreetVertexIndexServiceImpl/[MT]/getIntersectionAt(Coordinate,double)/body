{
  Envelope envelope=new Envelope(coordinate);
  envelope.expandBy(distanceError * 2);
  List<Vertex> nearby=verticesTree.query(envelope);
  StreetVertex nearest=null;
  double bestDistance=Double.POSITIVE_INFINITY;
  for (  Vertex v : nearby) {
    if (v instanceof StreetVertex) {
      double distance=coordinate.distance(v.getCoordinate());
      if (distance < distanceError) {
        if (distance < bestDistance) {
          bestDistance=distance;
          nearest=(StreetVertex)v;
        }
      }
    }
  }
  return nearest;
}
