{
  final Graph graph;
  try (InputStream is=graphInputStream.getGraphInputStream()){
    LOG.info("Loading graph...");
    try {
      graph=Graph.load(new ObjectInputStream(is),loadLevel,streetVertexIndexFactory);
    }
 catch (    Exception ex) {
      LOG.error("Exception while loading graph '{}'.",routerId);
      ex.printStackTrace();
      return null;
    }
    graph.routerId=(routerId);
  }
 catch (  IOException e) {
    LOG.warn("Graph file not found or not openable for routerId '{}': {}",routerId,e);
    return null;
  }
  try (InputStream is=graphInputStream.getConfigInputStream()){
    Preferences config=is == null ? null : new PropertiesPreferences(is);
    configurator.setupGraph(graph,config);
  }
 catch (  IOException e) {
    LOG.error("Can't read config file",e);
  }
  return graph;
}
