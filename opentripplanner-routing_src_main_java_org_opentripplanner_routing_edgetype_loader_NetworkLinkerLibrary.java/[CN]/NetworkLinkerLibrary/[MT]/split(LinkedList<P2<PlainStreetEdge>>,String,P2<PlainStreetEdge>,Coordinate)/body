{
  PlainStreetEdge e1=bestPair.getFirst();
  PlainStreetEdge e2=bestPair.getSecond();
  String name=e1.getName();
  StreetVertex e1v1=(StreetVertex)e1.getFromVertex();
  StreetVertex e1v2=(StreetVertex)e1.getToVertex();
  StreetVertex e2v1=(StreetVertex)e2.getFromVertex();
  StreetVertex e2v2=(StreetVertex)e2.getToVertex();
  LineString forwardGeometry=e1.getGeometry();
  LineString backGeometry=e2.getGeometry();
  P2<LineString> forwardGeometryPair=StreetLocation.splitGeometryAtPoint(forwardGeometry,coordinate);
  P2<LineString> backGeometryPair=StreetLocation.splitGeometryAtPoint(backGeometry,coordinate);
  LineString toMidpoint=forwardGeometryPair.getFirst();
  Coordinate midCoord=toMidpoint.getEndPoint().getCoordinate();
  double totalGeomLength=forwardGeometry.getLength();
  double lengthRatioIn=toMidpoint.getLength() / totalGeomLength;
  if (lengthRatioIn < 0.00001) {
    return Arrays.asList(e1v1,e2v2);
  }
 else   if (lengthRatioIn > 0.99999) {
    return Arrays.asList(e1v2,e2v1);
  }
  double lengthIn=e1.getLength() * lengthRatioIn;
  double lengthOut=e1.getLength() * (1 - lengthRatioIn);
  StreetVertex e1midpoint=new IntersectionVertex(graph,"split 1 at " + label,midCoord,name);
  StreetVertex e2midpoint=new IntersectionVertex(graph,"split 2 at " + label,midCoord,name);
  PlainStreetEdge forward1=new PlainStreetEdge(e1v1,e1midpoint,toMidpoint,name,lengthIn,e1.getPermission(),false);
  PlainStreetEdge forward2=new PlainStreetEdge(e1midpoint,e1v2,forwardGeometryPair.getSecond(),name,lengthOut,e1.getPermission(),true);
  PlainStreetEdge backward1=new PlainStreetEdge(e2v1,e2midpoint,backGeometryPair.getFirst(),name,lengthOut,e2.getPermission(),false);
  PlainStreetEdge backward2=new PlainStreetEdge(e2midpoint,e2v2,backGeometryPair.getSecond(),name,lengthIn,e2.getPermission(),true);
  double forwardBseLengthIn=e1.getBicycleSafetyEffectiveLength() * lengthRatioIn;
  double forwardBseLengthOut=e1.getBicycleSafetyEffectiveLength() * (1 - lengthRatioIn);
  forward1.setBicycleSafetyEffectiveLength(forwardBseLengthIn);
  forward2.setBicycleSafetyEffectiveLength(forwardBseLengthOut);
  double backwardBseLengthIn=e2.getBicycleSafetyEffectiveLength() * lengthRatioIn;
  double backwardBseLengthOut=e2.getBicycleSafetyEffectiveLength() * (1 - lengthRatioIn);
  backward1.setBicycleSafetyEffectiveLength(backwardBseLengthIn);
  backward2.setBicycleSafetyEffectiveLength(backwardBseLengthOut);
  forward1.setElevationProfile(e1.getElevationProfile(0,lengthIn),false);
  backward1.setElevationProfile(e2.getElevationProfile(0,lengthOut),false);
  forward2.setElevationProfile(e1.getElevationProfile(lengthOut,totalGeomLength),false);
  backward2.setElevationProfile(e2.getElevationProfile(lengthIn,totalGeomLength),false);
  ListIterator<P2<PlainStreetEdge>> it=replacement.listIterator();
  while (it.hasNext()) {
    P2<PlainStreetEdge> pair=it.next();
    if (pair == bestPair) {
      it.set(new P2<PlainStreetEdge>(forward1,backward2));
      it.add(new P2<PlainStreetEdge>(forward2,backward1));
      break;
    }
  }
  e1.detach();
  e2.detach();
  return Arrays.asList(e1midpoint,e2midpoint);
}
