{
  P2<Entry<StreetVertex,Set<Edge>>> ends=findEndVertices(edges);
  Entry<StreetVertex,Set<Edge>> start=ends.getFirst();
  Entry<StreetVertex,Set<Edge>> end=ends.getSecond();
  StreetVertex startVertex=start.getKey();
  StreetVertex endVertex=null;
  if (end != null) {
    endVertex=end.getKey();
  }
 else {
    return null;
  }
  Vertex newEnd=new GenericVertex("replace " + endVertex.getLabel(),endVertex.getX(),endVertex.getY());
  newEnd=graph.addVertex(newEnd);
  for (  DirectEdge e : filter(graph.getOutgoing(startVertex),DirectEdge.class)) {
    final Vertex toVertex=e.getToVertex();
    if (!toVertex.getCoordinate().equals(endVertex.getCoordinate())) {
      continue;
    }
    if (e instanceof TurnEdge) {
      final TurnEdge turnEdge=(TurnEdge)e;
      TinyTurnEdge newTurn=new TinyTurnEdge(newEnd,toVertex);
      newTurn.setRestricted(turnEdge.isRestricted());
      newTurn.setTurnCost(turnEdge.turnCost);
      graph.addEdge(newTurn);
    }
 else {
      graph.addEdge(new FreeEdge(newEnd,toVertex));
    }
  }
  Vertex newStart=new GenericVertex("replace " + startVertex.getLabel(),startVertex.getX(),startVertex.getY());
  newStart=graph.addVertex(newStart);
  for (  DirectEdge e : filter(graph.getOutgoing(endVertex),DirectEdge.class)) {
    final Vertex toVertex=e.getToVertex();
    if (!toVertex.getCoordinate().equals(startVertex.getCoordinate())) {
      continue;
    }
    if (e instanceof TurnEdge) {
      final TurnEdge turnEdge=(TurnEdge)e;
      TinyTurnEdge newTurn=new TinyTurnEdge(newStart,toVertex);
      newTurn.setRestricted(turnEdge.isRestricted());
      newTurn.setTurnCost(turnEdge.turnCost);
      graph.addEdge(newTurn);
    }
 else {
      graph.addEdge(new FreeEdge(newStart,toVertex));
    }
  }
  PlainStreetEdge forward=new PlainStreetEdge(startVertex,newEnd,startVertex.getGeometry(),startVertex.getName(),startVertex.getLength(),startVertex.getPermission(),false);
  PlainStreetEdge backward=new PlainStreetEdge(endVertex,newStart,endVertex.getGeometry(),endVertex.getName(),endVertex.getLength(),endVertex.getPermission(),true);
  forward.setWheelchairAccessible(startVertex.isWheelchairAccessible());
  backward.setWheelchairAccessible(endVertex.isWheelchairAccessible());
  forward.setElevationProfile(startVertex.getElevationProfile());
  backward.setElevationProfile(endVertex.getElevationProfile());
  forward.setBicycleSafetyEffectiveLength(startVertex.getBicycleSafetyEffectiveLength());
  backward.setBicycleSafetyEffectiveLength(endVertex.getBicycleSafetyEffectiveLength());
  P2<PlainStreetEdge> replacement=new P2<PlainStreetEdge>(forward,backward);
  return replacement;
}
