{
  P2<Entry<TurnVertex,Set<Edge>>> ends=findEndVertices(edges);
  Entry<TurnVertex,Set<Edge>> start=ends.getFirst();
  Entry<TurnVertex,Set<Edge>> end=ends.getSecond();
  TurnVertex startVertex=start.getKey();
  TurnVertex endVertex=null;
  if (end != null) {
    endVertex=end.getKey();
  }
 else {
    return null;
  }
  StreetVertex newEnd=new IntersectionVertex("replace " + endVertex.getLabel(),endVertex.getX(),endVertex.getY());
  graph.addVertex(newEnd);
  for (  DirectEdge e : filter(startVertex.getOutgoing(),DirectEdge.class)) {
    final Vertex toVertex=e.getToVertex();
    if (!toVertex.getCoordinate().equals(endVertex.getCoordinate())) {
      continue;
    }
    if (e instanceof TurnEdge) {
      final TurnEdge turnEdge=(TurnEdge)e;
      TinyTurnEdge newTurn=new TinyTurnEdge(newEnd,toVertex,turnEdge.getPermission());
      newTurn.setRestrictedModes(turnEdge.getRestrictedModes());
      newTurn.setTurnCost(turnEdge.turnCost);
    }
 else {
      new FreeEdge(newEnd,toVertex);
    }
  }
  StreetVertex newStart=new IntersectionVertex("replace " + startVertex.getLabel(),startVertex.getX(),startVertex.getY());
  graph.addVertex(newStart);
  for (  DirectEdge e : filter(endVertex.getOutgoing(),DirectEdge.class)) {
    final Vertex toVertex=e.getToVertex();
    if (!toVertex.getCoordinate().equals(startVertex.getCoordinate())) {
      continue;
    }
    if (e instanceof TurnEdge) {
      final TurnEdge turnEdge=(TurnEdge)e;
      TinyTurnEdge newTurn=new TinyTurnEdge(newStart,toVertex,turnEdge.getPermission());
      newTurn.setRestrictedModes(turnEdge.getRestrictedModes());
      newTurn.setTurnCost(turnEdge.turnCost);
    }
 else {
      new FreeEdge(newStart,toVertex);
    }
  }
  PlainStreetEdge forward=new PlainStreetEdge(startVertex,newEnd,startVertex.getGeometry(),startVertex.getName(),startVertex.getLength(),startVertex.getPermission(),false);
  PlainStreetEdge backward=new PlainStreetEdge(endVertex,newStart,endVertex.getGeometry(),endVertex.getName(),endVertex.getLength(),endVertex.getPermission(),true);
  forward.setWheelchairAccessible(startVertex.isWheelchairAccessible());
  backward.setWheelchairAccessible(endVertex.isWheelchairAccessible());
  forward.setElevationProfile(startVertex.getElevationProfile());
  backward.setElevationProfile(endVertex.getElevationProfile());
  forward.setBicycleSafetyEffectiveLength(startVertex.getBicycleSafetyEffectiveLength());
  backward.setBicycleSafetyEffectiveLength(endVertex.getBicycleSafetyEffectiveLength());
  P2<PlainStreetEdge> replacement=new P2<PlainStreetEdge>(forward,backward);
  return replacement;
}
