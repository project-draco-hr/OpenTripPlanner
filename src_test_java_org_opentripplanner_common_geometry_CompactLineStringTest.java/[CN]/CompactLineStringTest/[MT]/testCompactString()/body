{
  GeometryFactory gf=new GeometryFactory();
  List<Coordinate> c=new ArrayList<Coordinate>();
  double x0=1.111111111;
  double y0=0.123456789;
  double x1=2.0;
  double y1=0.0;
  c.add(new Coordinate(x0,y0));
  c.add(new Coordinate(x1,y1));
  LineString ls=gf.createLineString(c.toArray(new Coordinate[0]));
  int[] coords=CompactLineString.compactLineString(x0,y0,x1,y1,ls,false);
  assertTrue(coords == CompactLineString.STRAIGHT_LINE);
  LineString ls2=CompactLineString.uncompactLineString(x0,y0,x1,y1,coords,false);
  assertTrue(ls.equalsExact(ls2,0.00000015));
  byte[] packedCoords=CompactLineString.compackLineString(x0,y0,x1,y1,ls,false);
  assertTrue(packedCoords == CompactLineString.STRAIGHT_LINE_PACKED);
  ls2=CompactLineString.uncompackLineString(x0,y0,x1,y1,packedCoords,false);
  assertTrue(ls.equalsExact(ls2,0.00000015));
  c.clear();
  c.add(new Coordinate(x0,y0));
  c.add(new Coordinate(-179.99,1.12345));
  c.add(new Coordinate(179.99,1.12345));
  c.add(new Coordinate(x1,y1));
  ls=gf.createLineString(c.toArray(new Coordinate[0]));
  coords=CompactLineString.compactLineString(x0,y0,x1,y1,ls,false);
  assertTrue(coords != CompactLineString.STRAIGHT_LINE);
  ls2=CompactLineString.uncompactLineString(x0,y0,x1,y1,coords,false);
  assertTrue(ls.equalsExact(ls2,0.00000015));
  packedCoords=CompactLineString.compackLineString(x0,y0,x1,y1,ls,false);
  assertTrue(packedCoords != CompactLineString.STRAIGHT_LINE_PACKED);
  ls2=CompactLineString.uncompackLineString(x0,y0,x1,y1,packedCoords,false);
  assertTrue(ls.equalsExact(ls2,0.00000015));
  LineString lsi=(LineString)ls.reverse();
  int[] coords2=CompactLineString.compactLineString(x1,y1,x0,y0,ls,true);
  assertTrue(coords2 != CompactLineString.STRAIGHT_LINE);
  assertEquals(coords.length,coords2.length);
  for (int i=0; i < coords.length; i++)   assertEquals(coords[i],coords2[i]);
  ls2=CompactLineString.uncompactLineString(x1,y1,x0,y0,coords2,true);
  assertTrue(lsi.equalsExact(ls2,0.00000015));
  LineString ls3=CompactLineString.uncompactLineString(x1,y1,x0,y0,coords,true);
  assertTrue(lsi.equalsExact(ls3,0.00000015));
  byte[] packedCoords2=CompactLineString.compackLineString(x1,y1,x0,y0,ls,true);
  assertTrue(packedCoords2 != CompactLineString.STRAIGHT_LINE_PACKED);
  assertEquals(packedCoords.length,packedCoords2.length);
  for (int i=0; i < packedCoords.length; i++)   assertEquals(packedCoords[i],packedCoords2[i]);
  ls2=CompactLineString.uncompackLineString(x1,y1,x0,y0,packedCoords2,true);
  assertTrue(lsi.equalsExact(ls2,0.00000015));
  ls3=CompactLineString.uncompackLineString(x1,y1,x0,y0,packedCoords,true);
  assertTrue(lsi.equalsExact(ls2,0.00000015));
}
