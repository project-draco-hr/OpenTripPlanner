{
  _log.debug("creating linkages...");
  int i=0;
  ArrayList<Vertex> vertices=new ArrayList<Vertex>(graph.getVertices());
  for (  Vertex v : vertices) {
    if (i % 100000 == 0)     _log.debug("vertices=" + i + "/"+ vertices.size());
    i++;
    if (v instanceof TransitStop) {
      TransitStop ts=(TransitStop)v;
      if (!ts.isEntrance()) {
        boolean hasEntrance=false;
        for (        Edge e : v.getOutgoing()) {
          if (e instanceof PathwayEdge) {
            hasEntrance=true;
            break;
          }
        }
        if (hasEntrance) {
          continue;
        }
      }
      boolean wheelchairAccessible=ts.hasWheelchairEntrance();
      if (!networkLinkerLibrary.connectVertexToStreets(v,wheelchairAccessible)) {
        graph.addBuilderAnnotation(new GraphBuilderAnnotation(Variety.UNLINKED_STOP,ts));
      }
    }
  }
  networkLinkerLibrary.addAllReplacementEdgesToGraph();
  networkLinkerLibrary.markLocalStops();
  FindMaxWalkDistances.find(graph);
}
