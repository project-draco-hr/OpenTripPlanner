{
  double cte=crossTrackError(coord);
  double atd=alongTrackDistance(coord,cte);
  if (atd < 0) {
    return distanceLibrary.fastDistance(coord,start);
  }
 else   if (atd > lineLength) {
    return distanceLibrary.fastDistance(coord,end);
  }
 else {
    return FastMath.abs(cte);
  }
}
