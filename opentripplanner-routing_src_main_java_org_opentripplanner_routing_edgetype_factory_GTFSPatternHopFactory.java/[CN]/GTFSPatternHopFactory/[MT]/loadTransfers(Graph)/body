{
  Collection<Transfer> transfers=_dao.getAllTransfers();
  Set<org.opentripplanner.routing.edgetype.Transfer> createdTransfers=new HashSet<org.opentripplanner.routing.edgetype.Transfer>();
  for (  Transfer t : transfers) {
    Stop fromStop=t.getFromStop();
    Stop toStop=t.getToStop();
    if (fromStop == toStop) {
      continue;
    }
    TransitStop fromStation=(TransitStop)graph.getVertex(id(fromStop.getId()));
    TransitStop toStation=(TransitStop)graph.getVertex(id(toStop.getId()));
    double distance=fromStation.distance(toStation.getCoordinate());
    if (t.getTransferType() < 3) {
      org.opentripplanner.routing.edgetype.Transfer edge;
      if (t.getTransferType() == 2) {
        edge=new org.opentripplanner.routing.edgetype.Transfer(fromStation,toStation,distance,t.getMinTransferTime());
      }
 else {
        edge=new org.opentripplanner.routing.edgetype.Transfer(fromStation,toStation,distance);
      }
      if (createdTransfers.contains(edge)) {
        continue;
      }
      GeometryFactory factory=new GeometryFactory();
      LineString geometry=factory.createLineString(new Coordinate[]{new Coordinate(fromStop.getLon(),fromStop.getLat()),new Coordinate(toStop.getLon(),toStop.getLat())});
      edge.setGeometry(geometry);
      createdTransfers.add(edge);
      graph.addEdge(edge);
    }
  }
}
