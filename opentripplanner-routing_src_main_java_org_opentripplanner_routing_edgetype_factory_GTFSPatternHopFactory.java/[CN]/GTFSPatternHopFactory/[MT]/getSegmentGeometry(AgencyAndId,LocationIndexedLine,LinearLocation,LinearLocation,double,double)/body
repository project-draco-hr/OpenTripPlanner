{
  ShapeSegmentKey key=new ShapeSegmentKey(shapeId,startDistance,endDistance);
  Geometry geometry=_geometriesByShapeSegmentKey.get(key);
  if (geometry == null) {
    geometry=locationIndexedLine.extractLine(startIndex,endIndex);
    CoordinateSequence sequence=new PackedCoordinateSequence.Float(geometry.getCoordinates(),2);
    geometry=_factory.createLineString(sequence);
    _geometriesByShapeSegmentKey.put(key,(LineString)geometry);
  }
  return geometry;
}
