{
  ShapeSegmentKey key=new ShapeSegmentKey(shapeId,startDistance,endDistance);
  LineString geometry=_geometriesByShapeSegmentKey.get(key);
  if (geometry == null) {
    geometry=(LineString)locationIndexedLine.extractLine(startIndex,endIndex);
    CoordinateSequence sequence=new PackedCoordinateSequence.Float(geometry.getCoordinates(),2);
    geometry=_factory.createLineString(sequence);
    _geometriesByShapeSegmentKey.put(key,geometry);
  }
  return geometry;
}
