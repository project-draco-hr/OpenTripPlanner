{
  final Vertex v=s.getVertex();
  if (v instanceof StreetLocation) {
    return 0;
  }
  if (v instanceof StreetVertex) {
    if (s.isEverBoarded()) {
      return verticesNearTarget.get(v);
    }
 else {
      if (verticesNearOrigin.containsKey(v)) {
        return 0;
      }
 else {
        return Double.POSITIVE_INFINITY;
      }
    }
  }
 else {
    double h=verticesNearTarget.get(v);
    if (h == Double.POSITIVE_INFINITY) {
      return maxWeightSeen;
    }
 else {
      return h;
    }
  }
}
