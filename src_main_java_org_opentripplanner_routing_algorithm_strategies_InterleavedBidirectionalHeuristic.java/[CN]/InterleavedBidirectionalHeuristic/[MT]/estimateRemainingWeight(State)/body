{
  final Vertex v=s.getVertex();
  if (v instanceof StreetLocation)   return 0;
  double weight=weights.get(v);
  if (v instanceof StreetVertex) {
    if (weight == -1 && s.isEverBoarded())     return Double.POSITIVE_INFINITY;
    if (weight < 0)     return 0;
    return weight;
  }
  if (weight == Double.POSITIVE_INFINITY) {
    double dist=SphericalDistanceLibrary.fastDistance(v.getY(),v.getX(),target.getY(),target.getX());
    double time=dist / MAX_TRANSIT_SPEED;
    return Math.max(maxFound,time);
  }
  return weight;
}
