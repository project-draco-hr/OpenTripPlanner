{
  originalGraph=original;
  nVertices=Vertex.getMaxIndex();
  LOG.info("Table size is: {}",nVertices);
  vertex=new int[nVertices][];
  weight=new double[nVertices][];
  vertexByIndex=new Vertex[nVertices];
  TraverseOptions opt=new TraverseOptions();
  if (kind == INCOMING)   opt.setArriveBy(true);
  LOG.info("Loading origial graph into compact representation...");
  ArrayList<State> svs=new ArrayList<State>();
  for (  Vertex u : original.getVertices()) {
    State su=new State(u,opt);
    svs.clear();
    Iterable<Edge> edges;
    if (kind == INCOMING)     edges=u.getIncoming();
 else     edges=u.getOutgoing();
    for (    Edge e : edges) {
      State sv=e.optimisticTraverse(su);
      if (sv != null) {
        svs.add(sv);
      }
    }
    int ui=u.index;
    int ne=svs.size();
    vertex[ui]=new int[ne];
    weight[ui]=new double[ne];
    int ei=0;
    for (    State sv : svs) {
      vertex[ui][ei]=sv.getVertex().index;
      weight[ui][ei]=sv.getWeight();
      ei++;
    }
    vertexByIndex[ui]=u;
  }
  if (kind == UNDIRECTED)   this.symmetricize();
}
