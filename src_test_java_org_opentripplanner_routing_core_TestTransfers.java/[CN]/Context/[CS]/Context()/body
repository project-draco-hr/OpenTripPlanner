{
  aStar=new AStar();
  GtfsContext context=GtfsLibrary.readGtfs(new File(ConstantsForTests.FAKE_GTFS));
  graph=spy(new Graph());
  GTFSPatternHopFactory factory=new GTFSPatternHopFactory(context);
  factory.run(graph);
  graph.index(new DefaultStreetVertexIndexFactory());
  graph.putService(CalendarServiceData.class,GtfsLibrary.createCalendarServiceData(context.getDao()));
  createSimpleTransfer("agency:K","agency:F",100);
  createSimpleTransfer("agency:P","agency:U",100);
  createSimpleTransfer("agency:V","agency:I",100);
  TimetableSnapshot snapshot=new TimetableSnapshot();
  TimetableSnapshotSource timetableSnapshotSource=mock(TimetableSnapshotSource.class);
  when(timetableSnapshotSource.getTimetableSnapshot()).thenReturn(snapshot);
  graph.timetableSnapshotSource=(timetableSnapshotSource);
}
