{
  CalendarDate exception=calendar_dates.get(date);
  if (exception != null)   return exception.exception_type == 1;
 else   if (calendar == null)   return false;
 else {
    int gtfsDate=date.getYear() * 10000 + date.getMonthOfYear() * 100 + date.getDayOfMonth();
    return calendar.end_date >= gtfsDate && calendar.start_date <= gtfsDate;
  }
}
