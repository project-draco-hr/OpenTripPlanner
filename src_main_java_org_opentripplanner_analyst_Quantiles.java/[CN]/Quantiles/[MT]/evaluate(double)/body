{
  if (x < breaks[0]) {
    return 0;
  }
  for (int i=0; i < breaks.length - 1; i++) {
    double low=breaks[i];
    double high=breaks[i + 1];
    if (x < high) {
      double range=high - low;
      double fraction=(x - low) / range;
      int n_slices=breaks.length - 1;
      return ((i + fraction) / n_slices) * count;
    }
  }
  return count;
}
