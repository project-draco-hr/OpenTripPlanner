{
  if (delay == 0)   return 0;
  int n=stop - currentStop;
  double decay;
  if (linear)   decay=(n > k) ? 0.0 : 1.0 - n / k;
 else   decay=Math.pow(k,n);
  return (int)(decay * delay);
}
