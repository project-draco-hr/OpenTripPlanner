{
  this.errorList=errorList;
  ZipEntry entry=zip.getEntry(tableName + ".txt");
  if (entry == null) {
    if (required) {
      String msg=String.format("Required table '%s' was not present.",tableName);
      errorList.add(new Error(msg));
    }
    return;
  }
  LOG.info("Loading GTFS table {} from {}",tableName,entry);
  InputStream zis=zip.getInputStream(entry);
  CsvReader reader=new CsvReader(zis,',',Charset.forName("UTF8"));
  this.reader=reader;
  reader.readHeaders();
  checkRequiredColumns();
  int rec=0;
  while (reader.readRecord()) {
    if (++rec % 500000 == 0) {
      LOG.info("Record number {}",human(rec));
    }
    E entity=fromCsv();
    targetMap.put((K)(entity.getKey()),entity);
  }
}
