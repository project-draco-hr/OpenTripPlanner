{
  TraverseModeSet oldModes=options.modes;
  long oldWorstTime=options.worstTime;
  boolean oldBatch=options.batch;
  options.modes=options.modes.clone();
  options.modes.setTransit(false);
  options.worstTime=options.dateTime + (long)(options.maxWalkDistance / options.walkSpeed);
  options.batch=true;
  AStar astar=new AStar();
  ShortestPathTree spt=astar.getShortestPathTree(options);
  for (  TransitStop tstop : options.rctx.graph.index.stopVertexForStop.values()) {
    State s=spt.getState(tstop);
    if (s != null) {
      if (store.put(s))       markedPatterns.addAll(options.rctx.graph.index.patternsForStop.get(((TransitStop)s.getVertex()).getStop()));
    }
  }
  options.modes=oldModes;
  options.batch=oldBatch;
  options.worstTime=oldWorstTime;
}
