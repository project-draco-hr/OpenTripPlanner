{
  for (  TransitStop tstop : markedStops) {
    int timeAtOriginStop=bestFinalTimes.get(tstop);
    if (timeAtOriginStop < transferStops.get(tstop))     transferStops.put(tstop,timeAtOriginStop);
    for (    Edge e : tstop.getOutgoing()) {
      if (e instanceof SimpleTransfer) {
        TransitStop to=(TransitStop)e.getToVertex();
        int timeAtDestStop=(int)(bestFinalTimes.get(tstop) + e.getDistance() / walkSpeed);
        if (timeAtDestStop < bestFinalTimes.get(to) && timeAtDestStop < transferStops.get(to)) {
          transferStops.put(to,timeAtDestStop);
          markedPatterns.addAll(graph.index.patternsForStop.get(to.getStop()));
        }
      }
    }
  }
}
