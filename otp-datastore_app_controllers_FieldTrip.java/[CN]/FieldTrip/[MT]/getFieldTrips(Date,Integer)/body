{
  TrinetUser user=checkLogin();
  checkAccess(user);
  System.out.println("getFTs, date=" + date);
  List<ScheduledFieldTrip> trips;
  String sql="";
  if (date != null) {
    Calendar cal=Calendar.getInstance();
    cal.setTime(date);
    sql="year(serviceDay) = " + cal.get(Calendar.YEAR) + " and month(serviceDay) = "+ (cal.get(Calendar.MONTH) + 1)+ " and day(serviceDay) = "+ cal.get(Calendar.DAY_OF_MONTH)+ " ";
  }
  sql+="order by departure";
  if (limit == null)   trips=ScheduledFieldTrip.find(sql).fetch();
 else {
    trips=ScheduledFieldTrip.find(sql).fetch(limit);
  }
  Gson gson=new GsonBuilder().excludeFieldsWithoutExposeAnnotation().create();
  renderJSON(gson.toJson(trips));
}
