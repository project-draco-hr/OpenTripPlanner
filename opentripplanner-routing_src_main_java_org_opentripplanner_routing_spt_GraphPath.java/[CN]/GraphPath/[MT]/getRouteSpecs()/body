{
  List<RouteSpec> ret=new LinkedList<RouteSpec>();
  for (  State s : states) {
    Edge e=s.getBackEdge();
    Trip trip=null;
    if (e instanceof PatternBoard) {
      trip=s.getTripTimes().getTrip();
    }
 else     if (e instanceof Board) {
      trip=((Board)e).getTrip();
    }
    if (trip != null) {
      String routeName=GtfsLibrary.getRouteName(trip.getRoute());
      RouteSpec spec=new RouteSpec(trip.getId().getAgencyId(),routeName);
      ret.add(spec);
    }
  }
  return ret;
}
