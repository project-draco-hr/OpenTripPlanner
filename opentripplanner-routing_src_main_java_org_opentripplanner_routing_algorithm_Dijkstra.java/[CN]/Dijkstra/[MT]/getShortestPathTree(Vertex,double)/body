{
  while (!queue.empty()) {
    State su=queue.extract_min();
    if (!spt.visit(su))     continue;
    if (su.exceedsWeightLimit(weightLimit))     return spt;
    Vertex u=su.getVertex();
    if (u == target)     break;
    Iterable<Edge> outgoing=graph.getOutgoing(u);
    for (    Edge edge : outgoing) {
      State sv=edge.traverse(su,options);
      if (sv != null && spt.add(sv) && !sv.exceedsHopLimit(hopLimit))       queue.insert(sv,sv.getWeight());
    }
  }
  return spt;
}
