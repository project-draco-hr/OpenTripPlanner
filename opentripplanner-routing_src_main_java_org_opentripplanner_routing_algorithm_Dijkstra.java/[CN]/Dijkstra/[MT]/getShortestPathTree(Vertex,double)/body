{
  while (!queue.empty()) {
    State su=queue.extract_min();
    if (!spt.visit(su))     continue;
    if (su.exceedsWeightLimit(weightLimit))     return spt;
    Vertex u=su.getVertex();
    if (u == target)     break;
    Iterable<Edge> outgoing=u.getOutgoing();
    for (    Edge edge : outgoing) {
      State sv=edge.traverse(su);
      if (sv != null && sv.getVertex() != taboo && !sv.exceedsHopLimit(hopLimit) && spt.add(sv))       queue.insert(sv,sv.getWeight());
    }
  }
  return spt;
}
