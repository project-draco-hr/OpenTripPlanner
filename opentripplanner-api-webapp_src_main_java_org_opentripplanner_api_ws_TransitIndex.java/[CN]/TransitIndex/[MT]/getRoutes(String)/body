{
  TransitIndexService transitIndexService=graphService.getGraph().getService(TransitIndexService.class);
  if (transitIndexService == null) {
    return new TransitError("No transit index found.  Add TransitIndexBuilder to your graph builder configuration and rebuild your graph.");
  }
  RouteList response=new RouteList();
  for (  AgencyAndId routeId : transitIndexService.getAllRouteIds()) {
    for (    RouteVariant variant : transitIndexService.getVariantsForRoute(routeId)) {
      Route route=variant.getRoute();
      if (agency != null && !agency.equals(route.getAgency().getId()))       continue;
      TransitRoute transitRoute=new TransitRoute();
      transitRoute.id=route.getId();
      transitRoute.routeLongName=route.getLongName();
      transitRoute.routeShortName=route.getLongName();
      transitRoute.url=route.getUrl();
      response.routes.add(transitRoute);
      break;
    }
  }
  return response;
}
