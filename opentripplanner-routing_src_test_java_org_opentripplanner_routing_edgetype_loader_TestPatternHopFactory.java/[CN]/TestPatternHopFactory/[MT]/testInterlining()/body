{
  Vertex stop_i=graph.getVertex("agency_I_depart");
  Vertex stop_k=graph.getVertex("agency_K_arrive");
  long startTime=new GregorianCalendar(2009,8,19,12,0,0).getTimeInMillis();
  TraverseOptions options=new TraverseOptions(context);
  ShortestPathTree spt=AStar.getShortestPathTree(graph,stop_i,stop_k,startTime,options);
  GraphPath path=spt.getPath(stop_k,false);
  int num_alights=0;
  for (  State s : path.states) {
    if (s.getBackEdge() instanceof PatternAlight || s.getBackEdge() instanceof Alight) {
      num_alights+=1;
    }
    if (s.getBackEdge() instanceof PatternDwell) {
      assertEquals(10 * 60 * 1000,s.getTimeDeltaMsec());
    }
  }
  assertEquals(1,num_alights);
  options.setArriveBy(true);
  spt=AStar.getShortestPathTree(graph,stop_i,stop_k,startTime,options);
  path=spt.getPath(stop_i,false);
  num_alights=0;
  for (  State s : path.states) {
    if (s.getBackEdge() instanceof PatternAlight || s.getBackEdge() instanceof Alight) {
      num_alights+=1;
    }
    if (s.getBackEdge() instanceof PatternDwell) {
      assertEquals(10 * 60 * 1000,s.getTimeDeltaMsec());
    }
  }
  assertEquals(1,num_alights);
}
