{
  for (  Stop stop : _dao.getAllStops()) {
    Vertex vertex=_graph.addVertex(new GenericVertex(id(stop.getId()),stop.getLon(),stop.getLat()));
    vertex.setType(TransitStop.class);
  }
  if (verbose) {
    System.out.println("Loading hops");
  }
  GTFSHopFactory hf=new GTFSHopFactory(_context);
  ArrayList<Hop> hops=hf.run(verbose);
  for (  Hop hop : hops) {
    if (drawHandler != null) {
      drawHandler.handle(hop);
    }
    StopTime startStopTime=hop.getStartStopTime();
    StopTime endStopTime=hop.getEndStopTime();
    Stop startStop=startStopTime.getStop();
    Stop endStop=endStopTime.getStop();
    Vertex startStation=_graph.getVertex(id(startStop.getId()));
    Vertex endStation=_graph.getVertex(id(endStop.getId()));
    Vertex startJourney=_graph.addVertex(id(startStop.getId()) + "_" + id(startStopTime.getTrip().getId()),startStop.getLon(),startStop.getLat());
    Vertex endJourney=_graph.addVertex(id(endStop.getId()) + "_" + id(endStopTime.getTrip().getId()),endStop.getLon(),endStop.getLat());
    hop=new Hop(startJourney,endJourney,startStopTime,endStopTime);
    Board boarding=new Board(startStation,startJourney,hop);
    _graph.addEdge(boarding);
    _graph.addEdge(new Alight(endJourney,endStation));
    _graph.addEdge(hop);
  }
}
