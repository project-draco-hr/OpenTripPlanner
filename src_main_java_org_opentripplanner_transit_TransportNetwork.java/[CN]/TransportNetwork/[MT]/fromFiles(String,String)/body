{
  OSM osm=new OSM(null);
  osm.intersectionDetection=true;
  osm.readFromFile(osmSourceFile);
  StreetLayer streetLayer=new StreetLayer();
  streetLayer.loadFromOsm(osm);
  osm.close();
  TransitLayer transitLayer=TransitLayer.fromGtfs(gtfsSourceFile);
  streetLayer.indexStreets();
  streetLayer.associateStops(transitLayer,500);
  streetLayer.buildEdgeLists();
  transitLayer.rebuildTransientIndexes();
  new TransferFinder(transitLayer,streetLayer,1000).findTransfers();
  TransportNetwork transportNetwork=new TransportNetwork();
  transportNetwork.streetLayer=streetLayer;
  transportNetwork.transitLayer=transitLayer;
  return transportNetwork;
}
