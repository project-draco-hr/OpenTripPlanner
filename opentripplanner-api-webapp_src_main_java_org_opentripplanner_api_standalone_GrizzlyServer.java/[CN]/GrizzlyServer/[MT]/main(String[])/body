{
  LOG.info("Starting OTP Grizzly server...");
  HttpServer httpServer=new HttpServer();
  NetworkListener networkListener=new NetworkListener("sample-listener","localhost",PORT);
  ThreadPoolConfig threadPoolConfig=ThreadPoolConfig.defaultConfig().setCorePoolSize(2).setMaxPoolSize(4);
  networkListener.getTransport().setWorkerThreadPoolConfig(threadPoolConfig);
  httpServer.addListener(networkListener);
  ResourceConfig rc=new PackagesResourceConfig("org.opentripplanner");
  rc.getProperties().put(ResourceConfig.PROPERTY_CONTAINER_REQUEST_FILTERS,new String[]{JerseyAuthFilter.class.getName()});
  IoCComponentProviderFactory ioc_factory=createInjector(args);
  HttpHandler handler=ContainerFactory.createContainer(HttpHandler.class,rc,ioc_factory);
  httpServer.getServerConfiguration().addHttpHandler(handler,"/ws/");
  httpServer.getServerConfiguration().addHttpHandler(new StaticHttpHandler("./"),"/cp/");
  try {
    httpServer.start();
    LOG.info("Grizzly server running.");
    Thread.currentThread().join();
  }
 catch (  BindException be) {
    LOG.error("Cannot bind to port {}. Is it already in use?",PORT);
  }
catch (  InterruptedException ie) {
    httpServer.stop();
  }
}
