{
  GenericApplicationContext ctx=new GenericApplicationContext();
  XmlBeanDefinitionReader xmlReader=new XmlBeanDefinitionReader(ctx);
  xmlReader.loadBeanDefinitions(new ClassPathResource("org/opentripplanner/integration/application-context.xml"));
  Map<String,BeanDefinition> additionalBeans=getAdditionalBeans();
  for (  Map.Entry<String,BeanDefinition> entry : additionalBeans.entrySet())   ctx.registerBeanDefinition(entry.getKey(),entry.getValue());
  ctx.refresh();
  ctx.registerShutdownHook();
  return ctx;
}
